[![Node.js](https://img.shields.io/badge/Node.js-10.16.0-blue.svg)](https://nodejs.org/)
![Platforms](https://img.shields.io/badge/platform-windows%20%7C%20osx%20%7C%20linux-lightgray.svg)

*Forge API*:
[![oAuth2](https://img.shields.io/badge/oAuth2-v1-green.svg)](http://developer-autodesk.github.io/)
[![Data-Management](https://img.shields.io/badge/Data%20Management-v1-green.svg)](http://developer-autodesk.github.io/)
[![OSS](https://img.shields.io/badge/OSS-v2-green.svg)](http://developer-autodesk.github.io/)
[![Model-Derivative](https://img.shields.io/badge/Model%20Derivative-v2-green.svg)](http://developer-autodesk.github.io/)
[![Viewer](https://img.shields.io/badge/Forge%20Viewer-v7.3-green.svg)](http://developer-autodesk.github.io/)


# OTG / Fluent server


## Description

This sample is made for developers to debug OTG Viewer application locally. You are not authorized to use this server is a production or commercial environment.

We do recommend you to read the Viewer copyright and understands limitations in using local copies. Here is the copy of the Viewer copyright notice for your convenience.

```javascript
/*!
 * LMV v7.3.0
 * 
 * Copyright 2019 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
```

## Setup/Usage Instructions

  1. You should have completed the instructions from [../README.md](../README.md)
  2. Install Node.js dependency modules:<br />
     ```
     npm install
     ```
  3. Set your PORT variable to 7124
     ```
     export PORT=<7124
     ```
     Windows (use <b>Node.js command line</b> from Start menu)
     ```
     set PORT=7124
     ```

## Getting the OTG bubble

This utility does provide a way to download the SVF and OTG Bubbles on your local machine for debugging propose. (click &#9658; to expand)

<details>
   <summary>Download and run the SVF bubble</summary>

   ```bash
   # Do authorization/authentication.
   node forge.js 3legged auto

   # Get the list of Hubs.
   node forge.js hubs

   # Get the list of projects.
   node forge.js projects $MyHubID

   # Get the Project tree information.
   node forge.js projects-tree $MyHubID $MyProjectID

   # Download the SVF Bubble
   node forge.js bubble $MyVersionID ./bubbles/MyPath

   # Create an HTML page with your local URN
   node forge.js html /MyPath/bubble.json ./bubbles/output.html

   # Start local server and load the HTML page.
   open http://localhost:$PORT/output.html & http-server ./bubbles/
   ```

</details>

<details>
   <summary>Download and run the OTG bubble</summary>

   ``` bash
   # Do authorization/authentication.
   node forge.js 3legged auto

   # Get the list of Hubs.
   node forge.js hubs

   # Get the list of projects.
   node forge.js projects $hubid

   # Get the Project tree information.
   node forge.js projects-tree $hubid $projectid

   # Download the SVF Bubble
   node forge.js bubble $versionid ./bubbles/MyPath --otg

   # Create an HTML page with your local URN
   node forge.js html /MyPath/$VERSION_NUMBER/bubble.json ./bubbles/output.html

   # Start local server and load the HTML page.
   open http://localhost:7124/output.html & PORT=7124 & node fluent-server/start.js ./bubbles/
   ```

</details>

### OTG Viewer options

The Viewer can take to query parameter options which will change the way the Viewer is working and loading OTG.

* disableIndexedDb=boolean

  default: false - This options tells the Viewer to not store meshes, materials, etc... into a local database for faster future loading. Since OTG also share mesh definition via a hash code, models may share this data for faster experience.

  ex: http://localhost:7124/output.html?disableIndexedDb=true

* disableWebSocket=boolean

  default: false - This options tells the Viewer to only use HTTP request. By default, the Viewer gets meshes / materials definition via WebSockets. In case you only want to us HTTP, turn this option on.

  ex: http://localhost:7124/output.html?disableWebSockets=true

Both together

ex: http://localhost:7124/output.html?disableIndexedDb=true&disableWebSockets=true

## Tips & tricks

When running the OTG Bubble locally, you may get CORS issues. You can solce this problem by installing a Firefox or Chrome extension which will turn off CORS.

ex: https://chrome.google.com/webstore/detail/moesif-orign-cors-changer/digfbfaphojjndkpccljibejjbppifbc

## License

This sample is not licensed to you as open source, but is protected by the Autodesk copyright.

https://www.autodesk.com/company/legal-notices-trademarks/copyright-information

Please see the [LICENSE](LICENSE) file for full details.

## Written by

Cyrille Fauvel <br />
Forge Partner Development <br />
http://developer.autodesk.com/ <br />
http://around-the-corner.typepad.com <br />
